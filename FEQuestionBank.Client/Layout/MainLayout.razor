@using Microsoft.AspNetCore.Authorization
@* MainLayout.razor *@
@inherits LayoutComponentBase
@inject NavigationManager NavigationManager
@attribute [Authorize]   

<MudLayout>
    @* CHỈ HIỆN HEADER + SIDEBAR KHI ĐÃ ĐĂNG NHẬP *@
    @if (!IsPublicPage())
    {
        <Header OnMenuClick="ToggleDrawer" />
        <Sidebar Open="_drawerOpen" />
    }

    <MudMainContent Class="p-0">
        @Body
    </MudMainContent>
</MudLayout>

@code {
    private bool _drawerOpen = true;

    private void ToggleDrawer() => _drawerOpen = !_drawerOpen;

    private bool IsPublicPage()
    {
        var path = NavigationManager.ToBaseRelativePath(NavigationManager.Uri).ToLower();
        return path == "login" || 
               path == "register" || 
               path.StartsWith("forgot-password");
    }
}