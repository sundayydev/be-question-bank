@using Microsoft.AspNetCore.Authorization
@inherits LayoutComponentBase
@inject NavigationManager NavigationManager
@attribute [Authorize]  

<MudLayout>
    @if (!HideLayout)
    {
        <!-- Header -->
        <Header OnMenuClick="ToggleDrawer" />

        <!-- Sidebar -->
        <Sidebar Open="_drawerOpen" />
    }

    <!-- Nội dung chính -->
    <MudMainContent Class="@MainContentCssClass">
        @Body
    </MudMainContent>
</MudLayout>

@code {
    private bool _drawerOpen = true;

    private void ToggleDrawer()
    {
        _drawerOpen = !_drawerOpen;
        StateHasChanged();
    }

    private bool HideLayout => ShouldHideLayout();

    private bool ShouldHideLayout()
    {
        // Lấy đường dẫn hiện tại, loại bỏ domain
        var relativePath = NavigationManager.ToBaseRelativePath(NavigationManager.Uri).ToLower();

        // Danh sách các route muốn ẩn Header + Sidebar
        var hiddenPages = new[] { "login", "register", "forgot-password" };

        return hiddenPages.Any(p => relativePath.StartsWith(p));
        
    }
    private string MainContentCssClass => HideLayout ? "mud-main-content-auth" : "";
}